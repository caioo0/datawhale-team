# Part A: å†³ç­–æ ‘ï¼ˆä¸‹ï¼‰
----
ï¼ˆæœ¬å­¦ä¹ ç¬”è®°æ¥æºäº[DataWhale-æ ‘æ¨¡å‹ä¸é›†æˆå­¦ä¹ ](https://datawhalechina.github.io/machine-learning-toy-cod)ï¼‰ 

```md
The answer must be in the attempt.
ä½ æ‰€è¿½å¯»çš„ç­”æ¡ˆä¸€å®šä¼šåœ¨åŠªåŠ›æ¢ç´¢ä¸­å±•ç°ã€‚
```


æœ¬æ¬¡å†…å®¹ï¼š

å®ç°`CART`çš„åˆ†ç±»æ ‘ç®—æ³•ä»£ç 


å…³é”®çŸ¥è¯†ï¼š`ç†µ`,`ä¿¡æ¯ç†µ` ,`æ¡ä»¶ç†µ`,`ä¿¡æ¯å¢ç›Š`,`ä¿¡æ¯å¢ç›Šæ¯”`,`åŸºå°¼ç³»æ•°`ï¼Œ`å‰ªæ`

## ä¸€ã€åŸºæœ¬æ¦‚å¿µçŸ¥è¯†


### 1. ä¿¡æ¯ç†µï¼š

1.1 ç†µï¼šä¿¡æ¯çš„æœŸæœ›å€¼ï¼Œè¡¨ç¤ºéšæœºå˜é‡ä¸ç¡®å®šæ€§çš„åº¦é‡.å¦‚æœå¾…åˆ†ç±»çš„äº‹ç‰©å¯èƒ½åˆ’åˆ†åœ¨å¤šä¸ªåˆ†ç±»ä¹‹ä¸­ï¼Œåˆ™ç¬¦å·$x_{i}$çš„ä¿¡æ¯å®šä¹‰ä¸º ï¼š

$$
    I(x_{i})  = log_{2}\frac{1}{p(x_{i})} = - log_{2}p(x_{i})
$$

   å…¶ä¸­ï¼Œ$p(x_{i})$æ˜¯é€‰æ‹©è¯¥åˆ†ç±»çš„æ¦‚ç‡

1.2 ä¿¡æ¯ç†µï¼šè®¡ç®—æ‰€æœ‰ç±»åˆ«æ‰€æœ‰å¯èƒ½å€¼åŒ…å«çš„ä¿¡æ¯æœŸæœ›å€¼(æ•°å­¦æœŸæœ›)ï¼š

$$
    H = -\sum^{n}_{i=1}p(x_{i})log_{2}p(x_{i})
$$

   å…¶ä¸­ï¼Œ$p(x_{i})$æ˜¯é€‰æ‹©è¯¥åˆ†ç±»çš„æ¦‚ç‡ï¼Œ$n$æ˜¯åˆ†ç±»çš„æ•°ç›®ã€‚ç†µè¶Šå¤§ï¼Œéšæœºå˜é‡çš„ä¸ç¡®å®šæ€§å°±è¶Šå¤§ã€‚
   

å½“ç†µä¸­çš„æ¦‚ç‡ç”±æ•°æ®ä¼°è®¡(ç‰¹åˆ«æ˜¯æœ€å¤§ä¼¼ç„¶ä¼°è®¡)å¾—åˆ°æ—¶ï¼Œæ‰€å¯¹åº”çš„ç†µç§°ä¸ºç»éªŒç†µ(empirical entropy)ï¼Œä¿¡æ¯ç†µåˆç§°ä¸ºç»éªŒç†µã€‚

ä¿¡æ¯ç†µå…¬å¼


```python
"""
å‡½æ•°è¯´æ˜ï¼šè®¡ç®—ç»™å®šæ•°æ®å€¼å¾—ä¿¡æ¯ç†µï¼ˆç»éªŒç†µï¼‰

Parameters:
    dataSet - æ•°æ®é›†ï¼ˆå‡å®šæ‰€ç»™æ•°æ®é›†å‘é‡æœ€åä¸€åˆ—ä¸ºæ ‡ç­¾ï¼ˆLabelï¼‰ä¿¡æ¯ï¼‰
Returns:
    commEnt - ä¿¡æ¯ç†µï¼ˆç»éªŒç†µï¼‰
Author:
    Jo Choi (297495363@qq.com)
Modify:
    2021-10-16
"""

def calcomEntropy(dataSet,labelIndex):
    rowData = len(dataSet)                       # è¿”å›æ•°æ®é›†å¾—è¡Œæ•°ï¼ˆæ ·æœ¬å®¹é‡|D|ï¼‰
    labelCounts = {}                                 # ä¿å­˜æ¯ä¸ªæ ‡ç­¾ï¼ˆLabelï¼‰å‡ºç°æ¬¡æ•°çš„å­—å…¸
    for colVec in dataSet:                          # éå†æ•°æ®é›†ï¼ˆè·å–æ¯ä¸ªæ ·æœ¬æ ‡ç­¾ä¿¡æ¯(label),å¹¶ä¿å­˜ç»Ÿè®¡æ•°ï¼‰
        currentLabel = colVec[labelIndex]                    # æå–æ ‡ç­¾ï¼ˆLabelï¼‰ä¿¡æ¯ï¼Œ//rowVec[-1] æœ€åä¸€åˆ—ä¸ºæ ‡ç­¾
        if currentLabel not in labelCounts.keys():  # åˆ¤æ–­å½“å‰æ ‡ç­¾ï¼ˆlabelï¼‰æ²¡æœ‰åœ¨ç»Ÿè®¡æ¬¡æ•°å­—å…¸ï¼Œæ·»åŠ åˆå§‹å€¼ä¸º0
            labelCounts[currentLabel] = 0 
        labelCounts[currentLabel] += 1               # æ ‡ç­¾è®¡æ•°
         
    commEnt = 0.0                                     # åˆå§‹åŒ–ä¿¡æ¯ç†µï¼ˆç»éªŒç†µï¼‰ä¸º 0 
    for key in labelCounts:                          # éå†æ ‡ç­¾(labelCounts)ç»Ÿè®¡å­—å…¸ 
        prob    = float(labelCounts[key]) / rowData  # è®¡ç®—æ¦‚ç‡
        commEnt -= prob * log(prob,2)                #  éå†è®¡ç®—å…¬å¼
    return commEnt                                   # è¿”å›ä¿¡æ¯ç†µï¼ˆç»éªŒç†µï¼‰
```

ä¾‹å¦‚1ï¼š
æœ‰10ä¸ªæ•°æ®ï¼Œä¸€å…±æœ‰ä¸¤ä¸ªç±»åˆ«ï¼ŒAç±»å’ŒBç±»ã€‚å…¶ä¸­æœ‰7ä¸ªæ•°æ®å±äºAç±»ï¼Œåˆ™è¯¥Aç±»çš„æ¦‚ç‡å³ä¸ºååˆ†ä¹‹ä¸ƒã€‚å…¶ä¸­æœ‰3ä¸ªæ•°æ®å±äºBç±»ï¼Œåˆ™è¯¥Bç±»çš„æ¦‚ç‡å³ä¸ºååˆ†ä¹‹ä¸‰ã€‚
æˆ‘ä»¬å®šä¹‰è´·æ¬¾ç”³è¯·æ ·æœ¬æ•°æ®è¡¨ä¸­çš„æ•°æ®ä¸ºè®­ç»ƒæ•°æ®é›†Dï¼Œè®­ç»ƒæ•°æ®é›†Dçš„ç»éªŒç†µä¸ºH(D)ï¼Œ|D|è¡¨ç¤ºå…¶æ ·æœ¬å®¹é‡ï¼ŒåŠæ ·æœ¬ä¸ªæ•°ã€‚è®¾æœ‰Kä¸ªç±»Ck, = 1,2,3,...,K,|Ck|ä¸ºå±äºç±»Ckçš„æ ·æœ¬ä¸ªæ•°ï¼Œå› æ­¤ç»éªŒç†µå…¬å¼å°±å¯ä»¥å†™ä¸º ï¼š

$$
    H(D) = -\sum^{k}_{k=1}\frac{|C_{k}|}{|D|}log_{2}\frac{|C_{k}|}{|D|} 
$$

$\frac{|C_{k}|}{|D|}$ å¦‚åŒå‰é¢å…¬å¼$p(x_{i})$ï¼Œä»£å…¥æ•°æ®å¾—å‡ºç»éªŒç†µH(D):

$$
  H(D) = -\frac{7}{10}log_{2}\frac{7}{10}-\frac{3}{10}log_{2}\frac{3}{10} = 0.88
$$
 

ä»£ç å®ç°ï¼š


```python
from math import log

# ç›´æ¥è®¡ç®—
H = -log(0.7,2)*0.7 - log(0.3,2)*0.3
print("ç›´æ¥è®¡ç®—ä¿¡æ¯ç†µ:",H)

# è°ƒç”¨calcomEntropyå‡½æ•°
# é¦–å…ˆè½¬æ¢æ•°æ®é›†ï¼Œè¿™é‡Œåªç”¨äº†ä¸€ä¸ªç‰¹å¾
dataset = [['A'],['A'],['A'],['A'],['A'],['A'],['A'],['B'],['B'],['B']]
print("è°ƒç”¨å‡½æ•°è®¡ç®—:",calcomEntropy(dataset,-1))

```

    ç›´æ¥è®¡ç®—ä¿¡æ¯ç†µ: 0.8812908992306927
    è°ƒç”¨å‡½æ•°è®¡ç®—: 0.8812908992306927
    

ä¾‹å¦‚2ï¼šæˆ‘ä»¬çœ‹ä¸€ç»„è´·æ¬¾ç”³è¯·æ ·æœ¬æ•°æ®è¡¨ï¼š

![img](https://cuijiahua.com/wp-content/uploads/2017/11/m_2_2.jpg)

æ ¹æ®æ­¤å…¬å¼è®¡ç®—ç»éªŒç†µH(D)ï¼Œåˆ†æè´·æ¬¾ç”³è¯·æ ·æœ¬æ•°æ®è¡¨ä¸­çš„æ•°æ®ã€‚æœ€ç»ˆåˆ†ç±»ç»“æœåªæœ‰ä¸¤ç±»ï¼Œå³æ”¾è´·å’Œä¸æ”¾è´·ã€‚æ ¹æ®è¡¨ä¸­çš„æ•°æ®ç»Ÿè®¡å¯çŸ¥ï¼Œåœ¨15ä¸ªæ•°æ®ä¸­ï¼Œ9ä¸ªæ•°æ®çš„ç»“æœä¸ºæ”¾è´·ï¼Œ6ä¸ªæ•°æ®çš„ç»“æœä¸ºä¸æ”¾è´·ã€‚æ‰€ä»¥æ•°æ®é›†Dçš„ç»éªŒç†µH(D)ä¸ºï¼š

$$
  H(D) = -\frac{9}{15}log_{2}\frac{9}{15}-\frac{6}{15}log_{2}\frac{6}{15} = 0.971
$$
 

æˆ‘ä»¬å…ˆè½¬æ¢æ•°æ®æ ¼å¼ï¼š 
- å¹´é¾„ï¼š{0,1,2} 0:é’å¹´ï¼Œ1:ä¸­å¹´ï¼Œ2:è€å¹´ï¼›
- æœ‰å·¥ä½œï¼š{0,1} 0:å¦ï¼Œ1:æ˜¯ï¼›
- æœ‰è‡ªå·±çš„æˆ¿å­ï¼š{0,1} 0:å¦ï¼Œ1:æ˜¯ï¼›
- ä¿¡è´·æƒ…å†µï¼š{0,1,2} 0:ä¸€èˆ¬ï¼Œ1:å¥½ï¼Œ2:éå¸¸å¥½ï¼›
- ç±»åˆ«(æ˜¯å¦ç»™è´·æ¬¾)ï¼š{'no','yes'} no:å¦ï¼Œyes:æ˜¯ã€‚

åˆ›å»ºè½¬æ¢åæ•°æ®é›†:


```python
def createDataSet():
    dataSet = [[0, 0, 0, 0, 'no'],          # æ ¹æ®è¡¨æ ¼ç”Ÿæˆæ•°æ®é›†
            [0, 0, 0, 1, 'no'],
            [0, 1, 0, 1, 'yes'],
            [0, 1, 1, 0, 'yes'],
            [0, 0, 0, 0, 'no'],
            [1, 0, 0, 0, 'no'],
            [1, 0, 0, 1, 'no'],
            [1, 1, 1, 1, 'yes'],
            [1, 0, 1, 2, 'yes'],
            [1, 0, 1, 2, 'yes'],
            [2, 0, 1, 2, 'yes'],
            [2, 0, 1, 1, 'yes'],
            [2, 1, 0, 1, 'yes'],
            [2, 1, 0, 2, 'yes'],
            [2, 0, 0, 0, 'no']]
    labels = ['ä¸æ”¾è´·', 'æ”¾è´·']             # æ ‡ç­¾åˆ†ç±»å±æ€§
    return dataSet, labels                 # è¿”å›æ•°æ®é›†å’Œæ ‡ç­¾åˆ†ç±»å±æ€§
```

è®¡ç®—ä¿¡æ¯ç†µï¼ˆç»éªŒç†µï¼‰


```python
# è°ƒç”¨calcomEntropyå‡½æ•°
dataset,labels = createDataSet()
print(calcomEntropy(dataset,-1))
```

    0.9709505944546686
    

### æ¡ä»¶ç†µ


è¿™é‡Œç›´æ¥ç»™å‡ºå…¬å¼ï¼š

$$
H(D|A)  = -\sum^{n}_{i=1}\frac{|D_{i}|}{|D|}H(D_{i}) = -\sum^{n}_{i=1}\frac{|D_{i}|}{|D|}\sum^{k}_{k=1}\frac{|D_{ik}|}{|D_{i}|}log_{2}\frac{|D_{ik}|}{|D_{i}|} 
$$

ä»¥è´·æ¬¾ç”³è¯·æ ·æœ¬æ•°æ®è¡¨ä¸ºä¾‹è¿›è¡Œè¯´æ˜ã€‚

çœ‹ä¸‹å¹´é¾„è¿™ä¸€åˆ—çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯ç‰¹å¾A=å¹´é¾„ï¼Œä¸€å…±æœ‰ä¸‰ä¸ªç±»åˆ«ï¼Œåˆ†åˆ«æ˜¯ï¼š`é’å¹´`ã€`ä¸­å¹´`å’Œ`è€å¹´` åˆšå¥½æ˜¯5ä¸ªï¼Œåˆ†åˆ«å ä¸‰åˆ†ä¹‹ä¸€ã€‚

æœ‰ï¼š 
$$
H(D|A=å¹´é¾„)  =  (\frac{|D_{é’å¹´}|}{D} Ã— H(D_{é’å¹´})+(\frac{|D_{ä¸­å¹´}|}{D}Ã—H(D_{ä¸­å¹´})+(\frac{|D_{è€å¹´}|}{D}Ã—H(D_{è€å¹´}))
$$
$$
         =  (\frac{5}{15} Ã— H(D_{é’å¹´})+(\frac{5}{15}Ã—H(D_{ä¸­å¹´})+(\frac{5}{15}Ã—H(D_{è€å¹´}))
$$



 
 - $H(D_{é’å¹´}) = -\frac{2}{5}log_{2}\frac{2}{5}-\frac{3}{5}log_{2}\frac{3}{5}$ ,é’å¹´æœ€ç»ˆè´·æ¬¾çš„æ¦‚ç‡ä¸º`äº”åˆ†ä¹‹äºŒ`ï¼Œä¸æ”¾è´·ä¸º`äº”åˆ†ä¹‹ä¸‰`
 
 
 - $H(D_{ä¸­å¹´}) = -\frac{3}{5}log_{2}\frac{3}{5}-\frac{2}{5}log_{2}\frac{2}{5}$ ,é’å¹´æœ€ç»ˆè´·æ¬¾çš„æ¦‚ç‡ä¸º`äº”åˆ†ä¹‹ä¸‰`ï¼Œä¸æ”¾è´·ä¸º`äº”åˆ†ä¹‹äºŒ`
 
 
 - $H(D_{é’å¹´}) = -\frac{4}{5}log_{2}\frac{4}{5}-\frac{3}{5}log_{2}\frac{1}{5}$ ,é’å¹´æœ€ç»ˆè´·æ¬¾çš„æ¦‚ç‡ä¸º`äº”åˆ†ä¹‹å››`ï¼Œä¸æ”¾è´·ä¸º`äº”åˆ†ä¹‹ä¸€`
 
 
 
 é‚£ä¹ˆç‰¹å¾=å¹´é¾„æ¡ä»¶ç†µå¾—å‡ºæœ€ç»ˆæ•°æ®ä¸ºï¼š
 
 $$
       H(D|A=å¹´é¾„)   =  \frac{5}{15} Ã—(-\frac{2}{5}log_{2}\frac{2}{5}-\frac{3}{5}log_{2}\frac{3}{5})  
         + \frac{5}{15}Ã— (-\frac{3}{5}log_{2}\frac{3}{5}-\frac{2}{5}log_{2}\frac{2}{5})  
         + \frac{5}{15}Ã—(-\frac{4}{5}log_{2}\frac{4}{5}-\frac{3}{5}log_{2}\frac{1}{5})   = 0.888
$$


å…¬å¼å®ç°ï¼š

- é€‰å®šç‰¹å¾A 
- æ ¹æ®é€‰å®šç‰¹å¾è·å–åˆ†å¸ƒ{A1,A2,A3}
- è·å–ç‰¹å¾åˆ†å¸ƒå­æ•°æ®é›†


```python
"""
å‡½æ•°è¯´æ˜ï¼šæŒ‰ç…§ç»™å®šç‰¹å¾åˆ’åˆ†æ•°æ®é›†ã€€

Parameters:
    dataSet - å¸¦åˆ’åˆ†çš„æ•°æ®é›†
    axis    - åˆ’åˆ†æ•°æ®é›†çš„ç‰¹å¾
    value   - éœ€è¦è¿”å›çš„ç‰¹å¾çš„å€¼
Returns:
    retDataSet - åˆ’åˆ†ç‰¹å¾å­æ•°æ®é›†
Author:
    Jo Choi (297495363@qq.com)
Modify:
    2021-10-16
"""
def splitDataSet(dataSet,axis,value):
    retDataSet = []                                 #  åˆ›å»ºè¿”å›çš„æ•°æ®é›†åˆ—è¡¨
    for colVec in dataSet:                         # éå†æ•°æ®é›†
        if colVec[axis] ==value:                   # åˆ¤æ–­ç¬¦åˆæ¡ä»¶çš„
            reduceFeatVec = colVec[:axis]          # å»æ‰axisç‰¹å¾ï¼Œè¿”å›[0:axis)å…ƒç´ æ•°æ®
            reduceFeatVec.extend(colVec[axis+1:])  # è¿½åŠ åé¢çš„ç‰¹å¾æ•°æ®
            retDataSet.append(reduceFeatVec)
    return retDataSet                             # è¿”å›ç‰¹å¾åˆ’åˆ†æ•°æ®é›†

"""
å‡½æ•°è¯´æ˜ï¼šè®¡ç®—é€‰å®šç‰¹å¾æ•°æ®é›†çš„æ¡ä»¶ç†µã€€

Parameters:
    dataSet - æ‰€æœ‰æ•°æ®é›†
    labelIndex - æ ‡ç­¾ç´¢å¼• 
Returns:
    retDataSet - è¿”å›æ¯ä¸ªç‰¹å¾çš„æ¡ä»¶ç†µ
Author:
    Jo Choi (297495363@qq.com)
Modify:
    2021-10-16
"""
def conditionalEnt(dataSet,labelIndex):
    numFeatures = len(dataset[0])-1           # ç‰¹å¾æ•°ï¼Œæœ€åä¸€ä¸ªä¸ºæ ‡ç­¾å€¼
    retDataSet = []
    for i in range(numFeatures):
        featList = [rowdata[i] for rowdata in dataset]  # è·å–dataSetçš„ç¬¬iä¸ªæ‰€æœ‰ç‰¹å¾æ•°
        uniqueVals = set(featList)                       # åˆ›å»ºseté›†åˆ{}ï¼Œå»é‡
        conditEnt = 0.0                                  # åˆå§‹åŒ–ç‰¹å¾æ¡ä»¶ç†µ
        for value in uniqueVals:
            subdataSet= splitDataSet(dataset,i,value)    # åˆ’åˆ†åçš„å­é›†ï¼ˆsubdataSetï¼‰
            prob = len(subdataSet)/float(len(dataset))   # å­é›†çš„æ¦‚ç‡ 
            conditEnt += prob * calcomEntropy(subdataSet,labelIndex)# æ ¹æ®å…¬å¼è®¡ç®—æ¡ä»¶ç†µ å­é›†å æ‰€æœ‰æ•°æ®é›†æ¦‚ç‡ å‰Ã— å­é›†ä¿¡æ¯ç†µ ï¼ˆå åŠ ï¼‰
        retDataSet.append(conditEnt)

    return retDataSet                             # è¿”å›ç‰¹å¾åˆ’åˆ†æ•°æ®é›†

if __name__ == '__main__':
    dataset,labels = createDataSet()               # è·å–æ•°æ®é›†
    # è·å–æ¡ä»¶ç†µ
    conditEntVec = conditionalEnt(dataset,-1)      # è·å–æ¡ä»¶ç†µ 
    for i,value in (enumerate(conditEntVec)):
        print("ç¬¬%dä¸ªç‰¹å¾æ¡ä»¶ç†µä¸º%.3f" % (i, value))    
        print("----")
```

    {'no': 3, 'yes': 2}
    {'no': 2, 'yes': 3}
    {'yes': 4, 'no': 1}
    {'no': 6, 'yes': 4}
    {'yes': 5}
    {'no': 6, 'yes': 3}
    {'yes': 6}
    {'no': 4, 'yes': 1}
    {'no': 2, 'yes': 4}
    {'yes': 4}
    ç¬¬0ä¸ªç‰¹å¾æ¡ä»¶ç†µä¸º0.888
    ----
    ç¬¬1ä¸ªç‰¹å¾æ¡ä»¶ç†µä¸º0.647
    ----
    ç¬¬2ä¸ªç‰¹å¾æ¡ä»¶ç†µä¸º0.551
    ----
    ç¬¬3ä¸ªç‰¹å¾æ¡ä»¶ç†µä¸º0.608
    ----
    

### ä¿¡æ¯å¢ç›Š 


ç‰¹å¾ğ‘¨å¯¹è®­ç»ƒæ•°æ®é›†Dçš„ä¿¡æ¯å¢ç›Šğ’ˆ(ğ‘«, ğ‘¨)ï¼Œå®šä¹‰ä¸ºé›†åˆğ‘«çš„ç»éªŒç†µğ‘¯(ğ‘«)ä¸ç‰¹å¾ğ‘¨ç»™å®šæ¡ä»¶ä¸‹ğ‘«çš„ç»éªŒæ¡ä»¶ç†µğ‘¯(ğ‘«|ğ‘¨)ä¹‹å·®ï¼Œå³ï¼š

$$
g(D,A)  = H(D) - H(D|A)
$$

åœ¨ç‰¹å¾é€‰æ‹©çš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦é€‰æ‹©ä¿¡æ¯å¢ç›Šå€¼æœ€å¤§çš„çš„ç‰¹å¾ğ‘¨ã€‚


**ç®—æ³• 5.1 ï¼ˆä¿¡æ¯å¢ç›Šçš„ç®—æ³•ï¼‰**

è¾“å…¥ï¼šè®­ç»ƒæ•°æ®é›† D å’Œ ç‰¹å¾ A;  
è¾“å‡ºï¼šç‰¹å¾ A å¯¹è®­ç»ƒæ•°æ®é›† D çš„ä¿¡æ¯å¢ç›Š $g(D,A)$ã€‚  

ï¼ˆ1ï¼‰è®¡ç®—æ•°æ®é›† D çš„ç»éªŒç†µï¼ˆä¿¡æ¯ç†µï¼‰$H(D)$   
ï¼ˆ2ï¼‰è®¡ç®—ç‰¹å¾ A å¯¹æ•°æ®é›† D çš„ç»éªŒæ¡ä»¶ç†µï¼ˆæ¡ä»¶ç†µï¼‰ ï¼‰$H(D|A)$  
ï¼ˆ3ï¼‰è®¡ç®—ä¿¡æ¯å¢ç›Š


ä»¥è´·æ¬¾ç”³è¯·æ ·æœ¬æ•°æ®è¡¨ä¸ºä¾‹,è®¡ç®—æ¯ä¸ªç‰¹å¾çš„ä¿¡æ¯å¢ç›Šï¼š



```python
def calinfoGain(dataset):
    commEntVec = calcomEntropy(dataset,-1)       # è®¡ç®—ä¿¡æ¯ç†µ
    conditEntVec = conditionalEnt(dataset,-1)    # è®¡ç®—æ¡ä»¶ç†µ
    for i,value in enumerate(conditEntVec):   # éå†ç‰¹å¾çš„æ¡ä»¶ç†µ
        infoGain = commEntVec - value         # è®¡ç®—ä¿¡æ¯å¢ç›Š
        print("ç¬¬%dä¸ªç‰¹å¾çš„å¢ç›Šä¸º%.3f" % (i, infoGain))    
        print("----")
 
if __name__ == '__main__':
    
    dataset,labels = createDataSet()
    calinfoGain(dataset)
    
```

    ç¬¬0ä¸ªç‰¹å¾çš„å¢ç›Šä¸º0.083
    ----
    ç¬¬1ä¸ªç‰¹å¾çš„å¢ç›Šä¸º0.324
    ----
    ç¬¬2ä¸ªç‰¹å¾çš„å¢ç›Šä¸º0.420
    ----
    ç¬¬3ä¸ªç‰¹å¾çš„å¢ç›Šä¸º0.363
    ----
    

### ä¿¡æ¯å¢ç›Šæ¯”

ä¿¡æ¯å¢ç›Šæ¯”ç®—æ³•ä¿®æ­£äº†ä¿¡æ¯å¢ç›Šç®—æ³•ä¸­ä¼šå¯¹æŸä¸€ç‰¹å¾å–å€¼è¾ƒå¤šæ—¶äº§ç”Ÿåå‘çš„æƒ…å†µã€‚

 ä¿¡æ¯å¢ç›Šæ¯” = æƒ©ç½šå‚æ•° * ä¿¡æ¯å¢ç›Š
 
 å…¬å¼ï¼š
 
 $$
    g_{R}(D,A)  = \frac{g(D,A)}{H_{A}(D)}
 $$
 
 å…¶ä¸­ï¼š
$$
 H_{A}(D) = - \sum^{n}_{i=1}\frac{|D_{i}|}{|D|}log_{2}\frac{|D_{i}|}{|D|},n æ˜¯ç‰¹å¾ A å–å€¼çš„ä¸ªæ•°
 $$
 

 
 ä»¥è´·æ¬¾ç”³è¯·æ ·æœ¬æ•°æ®è¡¨ä¸ºä¾‹,è®¡ç®—ç‰¹å¾{å¹´é¾„}çš„ä¿¡æ¯å¢ç›Šæ¯”( é’å¹´=5 ï¼Œ ä¸­å¹´=5 ï¼Œ è€å¹´=5)ï¼š
 
$$
 H_{A}(D) = - (\frac{5}{15}log_{2}\frac{5}{15} + \frac{5}{15}log_{2}\frac{5}{15} + \frac{5}{15}log_{2}\frac{5}{15})
 $$
 
 


```python

```

    ç›´æ¥è®¡ç®—ä¿¡æ¯ç†µ: 1.5897956906195279
    


```python

"""
å‡½æ•°è¯´æ˜ï¼šè®¡ç®—ç»™å®šæ•°æ®å€¼å¾—ä¿¡æ¯ç†µï¼ˆç»éªŒç†µï¼‰

Parameters:
    dataSet - æ•°æ®é›†ï¼ˆå‡å®šæ‰€ç»™æ•°æ®é›†å‘é‡æœ€åä¸€åˆ—ä¸ºæ ‡ç­¾ï¼ˆLabelï¼‰ä¿¡æ¯ï¼‰
Returns:
    commEnt - ä¿¡æ¯ç†µï¼ˆç»éªŒç†µï¼‰
Author:
    Jo Choi (297495363@qq.com)
Modify:
    2021-10-16
"""

def calcomEntropy(dataSet,labelIndex):
    rowData = len(dataSet)                       # è¿”å›æ•°æ®é›†å¾—è¡Œæ•°ï¼ˆæ ·æœ¬å®¹é‡|D|ï¼‰
    labelCounts = {}                                 # ä¿å­˜æ¯ä¸ªæ ‡ç­¾ï¼ˆLabelï¼‰å‡ºç°æ¬¡æ•°çš„å­—å…¸
    for colVec in dataSet:                          # éå†æ•°æ®é›†ï¼ˆè·å–æ¯ä¸ªæ ·æœ¬æ ‡ç­¾ä¿¡æ¯(label),å¹¶ä¿å­˜ç»Ÿè®¡æ•°ï¼‰
        currentLabel = colVec[labelIndex]                    # æå–æ ‡ç­¾ï¼ˆLabelï¼‰ä¿¡æ¯ï¼Œ//rowVec[-1] æœ€åä¸€åˆ—ä¸ºæ ‡ç­¾
        if currentLabel not in labelCounts.keys():  # åˆ¤æ–­å½“å‰æ ‡ç­¾ï¼ˆlabelï¼‰æ²¡æœ‰åœ¨ç»Ÿè®¡æ¬¡æ•°å­—å…¸ï¼Œæ·»åŠ åˆå§‹å€¼ä¸º0
            labelCounts[currentLabel] = 0 
        labelCounts[currentLabel] += 1               # æ ‡ç­¾è®¡æ•°
         
    commEnt = 0.0                                     # åˆå§‹åŒ–ä¿¡æ¯ç†µï¼ˆç»éªŒç†µï¼‰ä¸º 0 
    for key in labelCounts:                          # éå†æ ‡ç­¾(labelCounts)ç»Ÿè®¡å­—å…¸ 
        prob    = float(labelCounts[key]) / rowData  # è®¡ç®—æ¦‚ç‡
        commEnt -= prob * log(prob,2)                #  éå†è®¡ç®—å…¬å¼
    return commEnt                                   # è¿”å›ä¿¡æ¯ç†µï¼ˆç»éªŒç†µï¼‰

"""
å‡½æ•°è¯´æ˜ï¼šè®¡ç®—ä¿¡æ¯å¢ç›Šæ¯”

Parameters:
    dataSet - æ•°æ®é›†
    labelindex - æ ‡ç­¾ç´¢å¼•
Returns:
    æ— 
Author:
    Jo Choi (297495363@qq.com)
Modify:
    2021-10-16
"""

def calinfoGainRadio(dataset,labelindex):

    commEnt = calcomEntropy(dataset,-1)          # è®¡ç®—ä¿¡æ¯ç†µ
    conditEntVec = conditionalEnt(dataset,-1)    # è®¡ç®—æ¡ä»¶ç†µ
    
    for i,value in enumerate(conditEntVec):      # éå†ç‰¹å¾çš„æ¡ä»¶ç†µ
        fealEnt = calcomEntropy(dataset,i)       # è®¡ç®—æƒ©ç½šç³»æ•°ï¼ˆç‰¹å¾ç†µ)
        infoGain = commEnt - value               # è®¡ç®—ä¿¡æ¯å¢ç›Š
        
        infoGainRadio = float(infoGain)/float(fealEnt)
        

        print("ç¬¬%dä¸ªç‰¹å¾çš„ç‰¹å¾ç†µ%.3fï¼Œä¿¡æ¯å¢ç›Š%.3fï¼Œå¢ç›Šæ¯”%.3f" % (i,fealEnt,infoGain,infoGainRadio))  
        print("----")
 
if __name__ == '__main__':
    
    dataset,labels = createDataSet()
    calinfoGainRadio(dataset,-1)
```

    ç¬¬0ä¸ªç‰¹å¾çš„ç‰¹å¾ç†µ1.585ï¼Œä¿¡æ¯å¢ç›Š0.083ï¼Œå¢ç›Šæ¯”0.052
    ----
    ç¬¬1ä¸ªç‰¹å¾çš„ç‰¹å¾ç†µ0.918ï¼Œä¿¡æ¯å¢ç›Š0.324ï¼Œå¢ç›Šæ¯”0.352
    ----
    ç¬¬2ä¸ªç‰¹å¾çš„ç‰¹å¾ç†µ0.971ï¼Œä¿¡æ¯å¢ç›Š0.420ï¼Œå¢ç›Šæ¯”0.433
    ----
    ç¬¬3ä¸ªç‰¹å¾çš„ç‰¹å¾ç†µ1.566ï¼Œä¿¡æ¯å¢ç›Š0.363ï¼Œå¢ç›Šæ¯”0.232
    ----
    

## äºŒã€ID3 ç®—æ³•ç”Ÿæˆå†³ç­–æ ‘

ID3 ç®—æ³•çš„æ ¸å¿ƒæ˜¯åœ¨å†³ç­–æ ‘å„ä¸ªç»“ç‚¹ä¸Šåº”ç”¨ä¿¡æ¯å¢ç›Šé€‰æ‹©ç‰¹å¾ï¼Œé€’å½’åœ°æ„å»ºå†³ç­–æ ‘ã€‚

å…·ä½“æ–¹æ³•æ˜¯ï¼šä»æ ¹ç»“ç‚¹ï¼ˆroot nodeï¼‰å¼€å§‹ï¼Œå¯¹ç»“ç‚¹è®¡ç®—æ‰€æœ‰å¯èƒ½çš„ç‰¹å¾çš„ä¿¡æ¯å¢ç›Šï¼Œé€‰æ‹©`ä¿¡æ¯å¢ç›Šæœ€å¤§`çš„ç‰¹å¾ä½œä¸ºç»“ç‚¹ï¼Œç”±è¯¥ç‰¹å¾çš„ä¸åŒå–å€¼å»ºç«‹å­ç»“ç‚¹ï¼›
å†å¯¹å­ç»“ç‚¹é€’å½’åœ°è°ƒç”¨ä»¥ä¸Šæ–¹æ³•ï¼Œæ„å»ºå†³ç­–æ ‘ï¼›ç›´åˆ°æ‰€æœ‰ç‰¹å¾çš„ä¿¡æ¯å¢ç›Šå‡å¾ˆå°æˆ–æ²¡æœ‰ç‰¹å¾å¯ä»¥é€‰æ‹©ä¸ºæ­¢ã€‚æœ€åå¾—åˆ°ä¸€æ£µå†³ç­–æ ‘ã€‚

ID3 ç›¸å½“äºæå¤§ä¼¼ç„¶æ³•è¿›è¡Œæ¦‚ç‡æ¨¡å‹çš„é€‰æ‹©ã€‚

  2.1 ç®—æ³•ï¼ˆID3 ç®—æ³•ï¼‰
 
  è¾“å…¥ï¼š è®­ç»ƒæ•°æ®é›†D,ç‰¹å¾å€¼A é˜ˆå€¼ $\varepsilon$ï¼›  
  è¾“å‡ºï¼š å†³ç­–æ ‘Tã€‚    
  ï¼ˆ1ï¼‰ è‹¥ D ä¸­æ‰€æœ‰å®ä¾‹å±äºåŒä¸€ç±»$C_{k}$,åˆ™ T ä¸ºå•ç»“ç‚¹æ ‘ï¼Œå¹¶å°†ç±» $C_{k}$ ä½œä¸ºè¯¥ç»“ç‚¹çš„ç±»æ ‡è®°ï¼Œè¿”å› Tï¼›   
  ï¼ˆ2ï¼‰ è‹¥ $A = \phi $ï¼Œåˆ™ T ä¸ºå•ç»“ç‚¹æ ‘ï¼Œå¹¶å°† D ä¸­å®ä¾‹æ•°æœ€å¤§çš„ç±» $C_{k}$ ä½œä¸ºè¯¥ç»“ç‚¹çš„ç±»æ ‡è®°ï¼Œè¿”å› Tï¼›    
  ï¼ˆ3ï¼‰å¦åˆ™ï¼Œè®¡ç®—ä¿¡æ¯å¢ç›Šï¼Œé€‰æ‹©ä¿¡æ¯å¢ç›Šæœ€å¤§çš„ç‰¹å¾ $A_{g}$ï¼›   
  ï¼ˆ4ï¼‰å¦‚æœ $A_{g}$ çš„ä¿¡æ¯å¢ç›Šå°äºé˜ˆå€¼  $\varepsilon$ ï¼Œåˆ™ T ä¸ºå•ç»“ç‚¹æ ‘ï¼Œå¹¶å°† D ä¸­å®ä¾‹æ ‘æœ€å¤§çš„ç±» $C_{k}$ ä½œä¸ºè¯¥ç»“ç‚¹çš„ç±»æ ‡è®°ï¼Œè¿”å› Tï¼›  
  ï¼ˆ5ï¼‰å¦åˆ™ï¼Œå¯¹ $A_{g}$ çš„æ¯ä¸€å¯èƒ½å€¼ $a_{i}$ï¼Œä¾ $A_{g} = a_{i}$ å°† D åˆ†å‰²ä¸ºè‹¥å¹²éç©ºå­é›† $D_{i}$ï¼Œ å°† $D_{i}$ ä¸­å®ä¾‹æ•°æœ€å¤§çš„ç±»ä½œä¸ºæ ‡è®°ï¼Œæ„å»ºå­ç»“ç‚¹ï¼Œç”±ç»“ç‚¹åŠå…¶å­ç»“ç‚¹æ„æˆæ ‘Tï¼Œè¿”å›Tï¼›    
  ï¼ˆ6ï¼‰å¯¹ç¬¬ $i$ ä¸ªå­ç»“ç‚¹ï¼Œä»¥ $D_{i}$ ä¸ºè®­ç»ƒé›†ï¼Œä»¥ $ A - {A_{g}}$ ä¸ºç‰¹å¾é›†ï¼Œé€’å½’åœ°è°ƒç”¨ä¸Šé¢æ­¥éª¤ï¼Œå¾—åˆ°å­æ ‘$T_{i}$,è¿”å›Tï¼›   
  
  






```python

"""
å‡½æ•°è¯´æ˜:åˆ›å»ºå†³ç­–æ ‘ID3 
 
Parameters:
    dataSet - è®­ç»ƒæ•°æ®é›†
    labels - åˆ†ç±»å±æ€§æ ‡ç­¾
    featLabels - å­˜å‚¨é€‰æ‹©çš„æœ€ä¼˜ç‰¹å¾æ ‡ç­¾
Returns:
    myTree - å†³ç­–æ ‘
Author:
   Jo Choi
Modify:
    2021-10-17
"""
```




    '\nå‡½æ•°è¯´æ˜:åˆ›å»ºå†³ç­–æ ‘ID3 \n \nParameters:\n    dataSet - è®­ç»ƒæ•°æ®é›†\n    labels - åˆ†ç±»å±æ€§æ ‡ç­¾\n    featLabels - å­˜å‚¨é€‰æ‹©çš„æœ€ä¼˜ç‰¹å¾æ ‡ç­¾\nReturns:\n    myTree - å†³ç­–æ ‘\nAuthor:\n    Jack Cui\nBlog:\n    http://blog.csdn.net/c406495762\nModify:\n    2017-07-25\n'



å®ä¾‹ï¼šhttps://cloud.tencent.com/developer/article/1648827


```python

```
